"use strict";(globalThis.webpackChunktal_docs=globalThis.webpackChunktal_docs||[]).push([[6323],{9172(e,s,t){t.r(s),t.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"reference/repo-map","title":"Repository Map","description":"A complete guide to the Tokamak AI Layer repository structure, key files, build commands, and test suite.","source":"@site/docs/reference/repo-map.md","sourceDirName":"reference","slug":"/reference/repo-map","permalink":"/reference/repo-map","draft":false,"unlisted":false,"editUrl":"https://github.com/tokamak-network/Tokamak-AI-Layer/tree/master/docs/docs/reference/repo-map.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Repository Map","sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Deployed Contracts","permalink":"/reference/deployed-contracts"}}');var r=t(4848),d=t(8453);const i={title:"Repository Map",sidebar_position:3},c="Repository Map",l={},o=[{value:"Directory Structure",id:"directory-structure",level:2},{value:"Key Files by Component",id:"key-files-by-component",level:2},{value:"Smart Contracts",id:"smart-contracts",level:3},{value:"SDK",id:"sdk",level:3},{value:"Frontend",id:"frontend",level:3},{value:"Build Commands",id:"build-commands",level:2},{value:"Test Suite Summary",id:"test-suite-summary",level:2},{value:"Gas Benchmarks",id:"gas-benchmarks",level:3},{value:"Design Patterns",id:"design-patterns",level:2}];function a(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"repository-map",children:"Repository Map"})}),"\n",(0,r.jsx)(s.p,{children:"A complete guide to the Tokamak AI Layer repository structure, key files, build commands, and test suite."}),"\n",(0,r.jsx)(s.h2,{id:"directory-structure",children:"Directory Structure"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Tokamak-AI-Layer/\n\u251c\u2500\u2500 contracts/                      # Foundry project - Solidity smart contracts\n\u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u251c\u2500\u2500 core/                   # Core protocol contracts\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TALIdentityRegistry.sol       # ERC-721 agent identity (905 lines)\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TALReputationRegistry.sol     # Feedback aggregation (717 lines)\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TALValidationRegistry.sol     # Multi-model validation + V3 features (1112 lines)\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 WSTONVault.sol               # L2 WSTON locking + slashing (280 lines)\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 TaskFeeEscrow.sol             # Non-upgradeable task fee escrow (193 lines)\n\u2502   \u2502   \u251c\u2500\u2500 bridge/                 # L1 <-> L2 cross-layer bridge\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TALStakingBridgeL2.sol        # L2 stake cache, tier management\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TALStakingBridgeL1.sol        # L1 stake queries, relay\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 TALSlashingConditionsL1.sol    # L1 slashing execution\n\u2502   \u2502   \u251c\u2500\u2500 modules/                # Integration modules\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 DRBIntegrationModule.sol      # Commit-Reveal2 validator selection\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 StakingIntegrationModule.sol  # Stake queries, seigniorage\n\u2502   \u2502   \u251c\u2500\u2500 interfaces/             # Contract interfaces (14 files)\n\u2502   \u2502   \u2514\u2500\u2500 libraries/              # Shared libraries\n\u2502   \u2502       \u251c\u2500\u2500 ReputationMath.sol            # Score normalization, weighted averages\n\u2502   \u2502       \u2514\u2500\u2500 SlashingCalculator.sol        # Slashing percentage calculations\n\u2502   \u251c\u2500\u2500 test/\n\u2502   \u2502   \u251c\u2500\u2500 unit/                   # Unit tests per contract\n\u2502   \u2502   \u251c\u2500\u2500 integration/            # Cross-layer, StakeSecured, TEE tests\n\u2502   \u2502   \u2514\u2500\u2500 GasBenchmarks.t.sol     # Gas usage benchmarks\n\u2502   \u2514\u2500\u2500 script/                     # Deployment scripts (Sepolia, Local, L1)\n\u2502\n\u251c\u2500\u2500 sdk/                            # TypeScript SDK\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 TALClient.ts            # Main facade (580 lines)\n\u2502       \u251c\u2500\u2500 identity/               # IdentityClient, RegistrationBuilder\n\u2502       \u251c\u2500\u2500 reputation/             # ReputationClient\n\u2502       \u251c\u2500\u2500 validation/             # ValidationClient\n\u2502       \u251c\u2500\u2500 zk/                     # ProofGenerator (STUBBED)\n\u2502       \u251c\u2500\u2500 subgraph/               # SubgraphClient (STUBBED)\n\u2502       \u251c\u2500\u2500 abi/                    # Contract ABIs (8 files, including V2/V3 ABIs)\n\u2502       \u251c\u2500\u2500 types/                  # TypeScript type definitions\n\u2502       \u2514\u2500\u2500 __tests__/              # SDK tests\n\u2502\n\u251c\u2500\u2500 frontend/                       # Next.js 14 web application\n\u2502   \u2514\u2500\u2500 src/\n\u2502       \u251c\u2500\u2500 app/                    # App Router pages\n\u2502       \u2502   \u251c\u2500\u2500 page.tsx            # Landing page\n\u2502       \u2502   \u251c\u2500\u2500 providers.tsx       # wagmi + RainbowKit providers\n\u2502       \u2502   \u251c\u2500\u2500 agents/             # /agents, /agents/[id], /agents/register, /agents/fees\n\u2502       \u2502   \u251c\u2500\u2500 reputation/         # /reputation/[agentId]\n\u2502       \u2502   \u251c\u2500\u2500 validation/         # /validation, /validation/[hash], /validation/request\n\u2502       \u2502   \u251c\u2500\u2500 staking/            # /staking\n\u2502       \u2502   \u2514\u2500\u2500 api/                # API routes (IPFS upload, runtime proxy)\n\u2502       \u251c\u2500\u2500 components/             # Shared UI components\n\u2502       \u251c\u2500\u2500 hooks/                  # Custom React hooks (14 files)\n\u2502       \u2514\u2500\u2500 lib/                    # Contract addresses, utilities\n\u2502\n\u251c\u2500\u2500 agent-examples/                 # Example AI agent implementations\n\u2502   \u251c\u2500\u2500 solidity-auditor/           # Express.js Solidity audit agent\n\u2502   \u2502   \u2514\u2500\u2500 src/\n\u2502   \u2502       \u251c\u2500\u2500 routes/             # Task submission, validation endpoints\n\u2502   \u2502       \u2514\u2500\u2500 agents/             # Agent implementations\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 trading-agent/              # DeFi trading agent (pnpm monorepo)\n\u2502   \u2502   \u2514\u2500\u2500 packages/\n\u2502   \u2502       \u251c\u2500\u2500 agent-core/         # Core logic: analysis, execution, lending, strategy\n\u2502   \u2502       \u251c\u2500\u2500 agent-server/       # Agent server\n\u2502   \u2502       \u251c\u2500\u2500 shared/             # Shared types and ABIs\n\u2502   \u2502       \u251c\u2500\u2500 siwa-auth/          # Sign-In With Agent authentication\n\u2502   \u2502       \u2514\u2500\u2500 tal-integration/    # TAL protocol integration\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 yield-agent/                # TAL Yield Agent (monorepo)\n\u2502       \u2514\u2500\u2500 packages/\n\u2502           \u251c\u2500\u2500 agent-core/         # Core yield agent logic\n\u2502           \u251c\u2500\u2500 agent-server/       # Agent server implementation\n\u2502           \u251c\u2500\u2500 agent-worker/       # Background worker\n\u2502           \u251c\u2500\u2500 shared/             # Shared types and ABIs\n\u2502           \u2514\u2500\u2500 tal-sdk/            # Agent-specific SDK wrapper\n\u2502\n\u251c\u2500\u2500 docs/                           # Docusaurus documentation site\n\u2502   \u2514\u2500\u2500 docs/                       # Documentation pages\n\u2502       \u251c\u2500\u2500 intro.md                # Introduction\n\u2502       \u251c\u2500\u2500 architecture/           # System architecture docs\n\u2502       \u251c\u2500\u2500 contracts/              # Smart contract docs\n\u2502       \u251c\u2500\u2500 sdk/                    # SDK documentation\n\u2502       \u251c\u2500\u2500 app/                    # Frontend app docs\n\u2502       \u251c\u2500\u2500 integration/            # Integration guides\n\u2502       \u2514\u2500\u2500 reference/              # Glossary, contracts, repo map\n\u2502\n\u2514\u2500\u2500 README.md                       # Project README\n"})}),"\n",(0,r.jsx)(s.h2,{id:"key-files-by-component",children:"Key Files by Component"}),"\n",(0,r.jsx)(s.h3,{id:"smart-contracts",children:"Smart Contracts"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"File"}),(0,r.jsx)(s.th,{children:"Purpose"}),(0,r.jsx)(s.th,{children:"Lines"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/core/TALIdentityRegistry.sol"})}),(0,r.jsx)(s.td,{children:"Agent identity NFTs, ZK commitments, operators"}),(0,r.jsx)(s.td,{children:"905"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/core/TALReputationRegistry.sol"})}),(0,r.jsx)(s.td,{children:"Feedback aggregation, payment proofs, Merkle trees"}),(0,r.jsx)(s.td,{children:"717"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/core/TALValidationRegistry.sol"})}),(0,r.jsx)(s.td,{children:"Multi-model validation, epoch stats, dual-staking, automated slashing"}),(0,r.jsx)(s.td,{children:"1,112"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/core/WSTONVault.sol"})}),(0,r.jsx)(s.td,{children:"L2 WSTON locking, operator tiers, slashing execution"}),(0,r.jsx)(s.td,{children:"280"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/core/TaskFeeEscrow.sol"})}),(0,r.jsx)(s.td,{children:"Non-upgradeable native TON task fee escrow"}),(0,r.jsx)(s.td,{children:"193"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/bridge/TALStakingBridgeL2.sol"})}),(0,r.jsx)(s.td,{children:"L2 cache of L1 stake data"}),(0,r.jsx)(s.td,{children:"--"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/bridge/TALStakingBridgeL1.sol"})}),(0,r.jsx)(s.td,{children:"L1 stake queries, cross-domain relay"}),(0,r.jsx)(s.td,{children:"--"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/modules/DRBIntegrationModule.sol"})}),(0,r.jsx)(s.td,{children:"Decentralized random beacon for validator selection"}),(0,r.jsx)(s.td,{children:"--"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/modules/StakingIntegrationModule.sol"})}),(0,r.jsx)(s.td,{children:"Stake queries, slashing, seigniorage"}),(0,r.jsx)(s.td,{children:"--"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/libraries/ReputationMath.sol"})}),(0,r.jsx)(s.td,{children:"Score normalization, weighted averages"}),(0,r.jsx)(s.td,{children:"--"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"contracts/src/libraries/SlashingCalculator.sol"})}),(0,r.jsx)(s.td,{children:"Slashing percentage calculations"}),(0,r.jsx)(s.td,{children:"--"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"sdk",children:"SDK"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"File"}),(0,r.jsx)(s.th,{children:"Purpose"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/TALClient.ts"})}),(0,r.jsx)(s.td,{children:"Main facade wrapping all domain clients (580 lines)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/identity/IdentityClient.ts"})}),(0,r.jsx)(s.td,{children:"Identity registration and querying"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/identity/RegistrationBuilder.ts"})}),(0,r.jsx)(s.td,{children:"Fluent builder for ERC-8004 registration files"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/reputation/ReputationClient.ts"})}),(0,r.jsx)(s.td,{children:"Reputation queries and feedback submission"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/validation/ValidationClient.ts"})}),(0,r.jsx)(s.td,{children:"Validation request and response management"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/types/index.ts"})}),(0,r.jsx)(s.td,{children:"All TypeScript type definitions (444 lines)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/abi/TALIdentityRegistry.ts"})}),(0,r.jsx)(s.td,{children:"Identity registry ABI"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/abi/TALIdentityRegistryV2.ts"})}),(0,r.jsx)(s.td,{children:"Identity registry V2 ABI"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/abi/TALIdentityRegistryV3.ts"})}),(0,r.jsx)(s.td,{children:"Identity registry V3 ABI"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/abi/TALReputationRegistry.ts"})}),(0,r.jsx)(s.td,{children:"Reputation registry ABI"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/abi/TALValidationRegistry.ts"})}),(0,r.jsx)(s.td,{children:"Validation registry ABI"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/abi/TALValidationRegistryV2.ts"})}),(0,r.jsx)(s.td,{children:"Validation registry V2 ABI"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/abi/TALValidationRegistryV3.ts"})}),(0,r.jsx)(s.td,{children:"Validation registry V3 ABI"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"sdk/src/abi/TaskFeeEscrow.ts"})}),(0,r.jsx)(s.td,{children:"Task fee escrow ABI"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"frontend",children:"Frontend"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"File"}),(0,r.jsx)(s.th,{children:"Purpose"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/app/providers.tsx"})}),(0,r.jsx)(s.td,{children:"wagmi, React Query, RainbowKit provider setup"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/lib/contracts.ts"})}),(0,r.jsx)(s.td,{children:"All contract addresses (L1 + L2) and chain IDs"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useAgent.ts"})}),(0,r.jsx)(s.td,{children:"Agent read hooks (single, count, list, by-owner)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useAgentMetadata.ts"})}),(0,r.jsx)(s.td,{children:"IPFS metadata fetching with gateway fallback"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useAgentRuntime.ts"})}),(0,r.jsx)(s.td,{children:"Agent runtime API communication"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useDeregisterAgent.ts"})}),(0,r.jsx)(s.td,{children:"Agent deregistration write hook"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useL2Config.ts"})}),(0,r.jsx)(s.td,{children:"L2 chain configuration hook"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useOperatorManagement.ts"})}),(0,r.jsx)(s.td,{children:"Operator add/remove/exit hooks"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useRegisterAgent.ts"})}),(0,r.jsx)(s.td,{children:"Agent registration write hook"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useReputation.ts"})}),(0,r.jsx)(s.td,{children:"Reputation read hooks (feedback, summary, ratings)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useStaking.ts"})}),(0,r.jsx)(s.td,{children:"L1 staking read/write hooks"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useSubmitFeedback.ts"})}),(0,r.jsx)(s.td,{children:"Feedback submission write hook"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useTaskFee.ts"})}),(0,r.jsx)(s.td,{children:"Task fee escrow hooks"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useValidation.ts"})}),(0,r.jsx)(s.td,{children:"Validation read/write hooks"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useVault.ts"})}),(0,r.jsx)(s.td,{children:"WSTONVault lock/unlock/slash hooks"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"frontend/src/hooks/useWallet.ts"})}),(0,r.jsx)(s.td,{children:"Wallet state and network switching"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"build-commands",children:"Build Commands"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Component"}),(0,r.jsx)(s.th,{children:"Command"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Contracts"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd contracts && forge build"})}),(0,r.jsx)(s.td,{children:"Compile Solidity contracts"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Contracts"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd contracts && forge test"})}),(0,r.jsx)(s.td,{children:"Run all Foundry tests"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Contracts"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd contracts && forge test --gas-report"})}),(0,r.jsx)(s.td,{children:"Run tests with gas reporting"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"SDK"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd sdk && npm install"})}),(0,r.jsx)(s.td,{children:"Install SDK dependencies"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"SDK"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd sdk && npm run build"})}),(0,r.jsx)(s.td,{children:"Build SDK with tsup"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"SDK"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd sdk && npm test"})}),(0,r.jsx)(s.td,{children:"Run vitest test suite"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Frontend"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd frontend && npm install"})}),(0,r.jsx)(s.td,{children:"Install frontend dependencies"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Frontend"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd frontend && npm run dev"})}),(0,r.jsx)(s.td,{children:"Start development server"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Frontend"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd frontend && npm run build"})}),(0,r.jsx)(s.td,{children:"Build production bundle"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Frontend"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd frontend && npm run lint"})}),(0,r.jsx)(s.td,{children:"Run ESLint"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Frontend"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cd frontend && npm run typecheck"})}),(0,r.jsx)(s.td,{children:"Run TypeScript type checking"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"test-suite-summary",children:"Test Suite Summary"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Test File"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Tests"}),(0,r.jsx)(s.th,{children:"Status"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"TALIdentityRegistry.t.sol"})}),(0,r.jsx)(s.td,{children:"Unit"}),(0,r.jsx)(s.td,{children:"83"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"TALReputationRegistry.t.sol"})}),(0,r.jsx)(s.td,{children:"Unit"}),(0,r.jsx)(s.td,{children:"63"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"ReputationMath.t.sol"})}),(0,r.jsx)(s.td,{children:"Unit"}),(0,r.jsx)(s.td,{children:"57"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"TaskFeeEscrow.t.sol"})}),(0,r.jsx)(s.td,{children:"Unit"}),(0,r.jsx)(s.td,{children:"59"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"WSTONVault.t.sol"})}),(0,r.jsx)(s.td,{children:"Unit"}),(0,r.jsx)(s.td,{children:"44"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"DRBIntegrationModule.t.sol"})}),(0,r.jsx)(s.td,{children:"Unit"}),(0,r.jsx)(s.td,{children:"27"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"StakingIntegrationModule.t.sol"})}),(0,r.jsx)(s.td,{children:"Unit"}),(0,r.jsx)(s.td,{children:"28"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"StakeSecuredValidation.t.sol"})}),(0,r.jsx)(s.td,{children:"Integration"}),(0,r.jsx)(s.td,{children:"12"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"TEEAttestedValidation.t.sol"})}),(0,r.jsx)(s.td,{children:"Integration"}),(0,r.jsx)(s.td,{children:"20"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"GasBenchmarks.t.sol"})}),(0,r.jsx)(s.td,{children:"Benchmark"}),(0,r.jsx)(s.td,{children:"11"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"SDK tests (4 files)"}),(0,r.jsx)(s.td,{children:"Unit"}),(0,r.jsx)(s.td,{children:"35"}),(0,r.jsx)(s.td,{children:"Passing"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Total"})}),(0,r.jsx)(s.td,{}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"439"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"All Passing"})})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"gas-benchmarks",children:"Gas Benchmarks"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Operation"}),(0,r.jsx)(s.th,{children:"Gas"}),(0,r.jsx)(s.th,{children:"Target"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"register()"})}),(0,r.jsx)(s.td,{children:"~143k"}),(0,r.jsx)(s.td,{children:"Within threshold"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"submitFeedback()"})}),(0,r.jsx)(s.td,{children:"~318k"}),(0,r.jsx)(s.td,{children:"Within threshold"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"requestValidation()"})}),(0,r.jsx)(s.td,{children:"~277k"}),(0,r.jsx)(s.td,{children:"Within threshold"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"design-patterns",children:"Design Patterns"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Pattern"}),(0,r.jsx)(s.th,{children:"Where Used"}),(0,r.jsx)(s.th,{children:"Purpose"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"UUPS Proxy"}),(0,r.jsx)(s.td,{children:"Identity, Reputation, Validation registries"}),(0,r.jsx)(s.td,{children:"Upgradeability without redeployment (V1 \u2192 V2 \u2192 V3 chain)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"AccessControl (RBAC)"}),(0,r.jsx)(s.td,{children:"All core contracts"}),(0,r.jsx)(s.td,{children:"Role-based permissions (UPGRADER, PAUSER, TEE_MANAGER, DRB, SLASH)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Storage Gap"}),(0,r.jsx)(s.td,{children:"All upgradeable contracts"}),(0,r.jsxs)(s.td,{children:["Versioned gaps (",(0,r.jsx)(s.code,{children:"__gap[40]"}),", ",(0,r.jsx)(s.code,{children:"__gapV2[38]"}),", ",(0,r.jsx)(s.code,{children:"__gapV3[36]"}),") for future storage slots"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"ReentrancyGuard"}),(0,r.jsx)(s.td,{children:"State-changing functions"}),(0,r.jsx)(s.td,{children:"Prevent reentrancy attacks"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Pausable"}),(0,r.jsx)(s.td,{children:"All core contracts"}),(0,r.jsx)(s.td,{children:"Emergency pause functionality"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Immutable"}),(0,r.jsx)(s.td,{children:"TaskFeeEscrow, WSTONVault"}),(0,r.jsx)(s.td,{children:"Non-upgradeable contracts for stronger fund safety"})]})]})]}),"\n",(0,r.jsxs)(s.admonition,{title:"Commonly Modified Files",type:"tip",children:[(0,r.jsx)(s.p,{children:"When making changes to the project, these are the most frequently edited files:"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"New contract features"}),": ",(0,r.jsx)(s.code,{children:"contracts/src/core/*.sol"})," + corresponding test in ",(0,r.jsx)(s.code,{children:"contracts/test/"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"SDK changes"}),": ",(0,r.jsx)(s.code,{children:"sdk/src/TALClient.ts"})," (facade) + domain clients in ",(0,r.jsx)(s.code,{children:"sdk/src/{identity,reputation,validation}/"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"New types"}),": ",(0,r.jsx)(s.code,{children:"sdk/src/types/index.ts"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Frontend pages"}),": ",(0,r.jsx)(s.code,{children:"frontend/src/app/*/page.tsx"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Contract hooks"}),": ",(0,r.jsx)(s.code,{children:"frontend/src/hooks/use*.ts"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Contract addresses"}),": ",(0,r.jsx)(s.code,{children:"frontend/src/lib/contracts.ts"})," AND ",(0,r.jsx)(s.code,{children:"sdk/src/types/index.ts"})]}),"\n"]})]})]})}function h(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453(e,s,t){t.d(s,{R:()=>i,x:()=>c});var n=t(6540);const r={},d=n.createContext(r);function i(e){const s=n.useContext(d);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(d.Provider,{value:s},e.children)}}}]);