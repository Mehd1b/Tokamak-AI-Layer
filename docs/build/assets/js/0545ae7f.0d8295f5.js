"use strict";(globalThis.webpackChunktal_docs=globalThis.webpackChunktal_docs||[]).push([[3390],{8172(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"app/wallet-and-chains","title":"Wallet & Chains","description":"The TAL frontend uses RainbowKit for wallet connection UI and wagmi v2 for React hooks that interact with Ethereum-compatible chains. The application operates across two networks: Thanos Sepolia (L2) for core protocol operations and Ethereum Sepolia (L1) for staking.","source":"@site/docs/app/wallet-and-chains.md","sourceDirName":"app","slug":"/app/wallet-and-chains","permalink":"/app/wallet-and-chains","draft":false,"unlisted":false,"editUrl":"https://github.com/tokamak-network/Tokamak-AI-Layer/tree/master/docs/docs/app/wallet-and-chains.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Wallet & Chains","sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Pages Guide","permalink":"/app/pages-guide"},"next":{"title":"Hooks Reference","permalink":"/app/hooks-reference"}}');var r=i(4848),s=i(8453);const a={title:"Wallet & Chains",sidebar_position:3},o="Wallet & Chains",c={},l=[{value:"Provider Architecture",id:"provider-architecture",level:2},{value:"Full Provider Setup",id:"full-provider-setup",level:3},{value:"Chain Definitions",id:"chain-definitions",level:2},{value:"Thanos Sepolia (L2) -- Primary Chain",id:"thanos-sepolia-l2----primary-chain",level:3},{value:"Sepolia (L1) -- Staking Chain",id:"sepolia-l1----staking-chain",level:3},{value:"Network Switching",id:"network-switching",level:2},{value:"Usage in Components",id:"usage-in-components",level:3},{value:"Wallet Connection Flow",id:"wallet-connection-flow",level:2},{value:"React Query Configuration",id:"react-query-configuration",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"wallet--chains",children:"Wallet & Chains"})}),"\n",(0,r.jsxs)(n.p,{children:["The TAL frontend uses ",(0,r.jsx)(n.strong,{children:"RainbowKit"})," for wallet connection UI and ",(0,r.jsx)(n.strong,{children:"wagmi v2"})," for React hooks that interact with Ethereum-compatible chains. The application operates across two networks: ",(0,r.jsx)(n.strong,{children:"Thanos Sepolia"})," (L2) for core protocol operations and ",(0,r.jsx)(n.strong,{children:"Ethereum Sepolia"})," (L1) for staking."]}),"\n",(0,r.jsx)(n.h2,{id:"provider-architecture",children:"Provider Architecture"}),"\n",(0,r.jsxs)(n.p,{children:["The provider hierarchy is defined in ",(0,r.jsx)(n.code,{children:"frontend/src/app/providers.tsx"}),":"]}),"\n",(0,r.jsx)(n.mermaid,{value:'graph TD\n    A[WagmiProvider] --\x3e B[QueryClientProvider]\n    B --\x3e C[RainbowKitProvider]\n    C --\x3e D[App Children]\n    A -.->|config| E[wagmi config]\n    E -.->|chains| F["Thanos Sepolia (L2)"]\n    E -.->|chains| G["Sepolia (L1)"]\n    B -.->|client| H[React Query Client]'}),"\n",(0,r.jsx)(n.h3,{id:"full-provider-setup",children:"Full Provider Setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"'use client';\n\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { WagmiProvider, http } from 'wagmi';\nimport { sepolia, type Chain } from 'wagmi/chains';\nimport { RainbowKitProvider, getDefaultConfig } from '@rainbow-me/rainbowkit';\nimport '@rainbow-me/rainbowkit/styles.css';\nimport { useState, type ReactNode } from 'react';\n\nconst thanosSepolia = {\n  id: 111551119090,\n  name: 'Thanos Sepolia',\n  nativeCurrency: {\n    name: 'Tokamak Network Token',\n    symbol: 'TON',\n    decimals: 18,\n  },\n  rpcUrls: {\n    default: { http: ['https://rpc.thanos-sepolia.tokamak.network'] },\n  },\n  blockExplorers: {\n    default: {\n      name: 'Thanos Explorer',\n      url: 'https://explorer.thanos-sepolia.tokamak.network',\n    },\n  },\n  testnet: true,\n} as const satisfies Chain;\n\nconst config = getDefaultConfig({\n  appName: 'Tokamak Agent Layer',\n  projectId: process.env.NEXT_PUBLIC_WALLET_CONNECT_ID || 'placeholder',\n  chains: [thanosSepolia, sepolia],\n  transports: {\n    [thanosSepolia.id]: http('https://rpc.thanos-sepolia.tokamak.network'),\n    [sepolia.id]: http(),\n  },\n  ssr: true,\n});\n\nexport function Providers({ children }: { children: ReactNode }) {\n  const [queryClient] = useState(\n    () =>\n      new QueryClient({\n        defaultOptions: {\n          queries: {\n            staleTime: 60 * 1000,\n            refetchOnWindowFocus: false,\n          },\n        },\n      }),\n  );\n\n  return (\n    <WagmiProvider config={config}>\n      <QueryClientProvider client={queryClient}>\n        <RainbowKitProvider>{children}</RainbowKitProvider>\n      </QueryClientProvider>\n    </WagmiProvider>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"chain-definitions",children:"Chain Definitions"}),"\n",(0,r.jsx)(n.h3,{id:"thanos-sepolia-l2----primary-chain",children:"Thanos Sepolia (L2) -- Primary Chain"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Value"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Chain ID"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"111551119090"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Name"}),(0,r.jsx)(n.td,{children:"Thanos Sepolia"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Native Currency"}),(0,r.jsx)(n.td,{children:"TON (18 decimals)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"RPC URL"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"https://rpc.thanos-sepolia.tokamak.network"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Block Explorer"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"https://explorer.thanos-sepolia.tokamak.network"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Testnet"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"true"})})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Used for: agent registration, reputation feedback, validation requests, task fee escrow."}),"\n",(0,r.jsx)(n.h3,{id:"sepolia-l1----staking-chain",children:"Sepolia (L1) -- Staking Chain"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Value"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Chain ID"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"11155111"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Name"}),(0,r.jsx)(n.td,{children:"Sepolia"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Native Currency"}),(0,r.jsx)(n.td,{children:"ETH (18 decimals)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"RPC URL"}),(0,r.jsx)(n.td,{children:"wagmi default Sepolia RPC"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Block Explorer"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"https://sepolia.etherscan.io"})})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Used for: TON/WTON token operations, staking deposits and withdrawals via DepositManager."}),"\n",(0,r.jsx)(n.h2,{id:"network-switching",children:"Network Switching"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"useWallet"})," hook (defined in ",(0,r.jsx)(n.code,{children:"frontend/src/hooks/useWallet.ts"}),") provides helpers for detecting and switching networks:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { useAccount, useChainId, useSwitchChain } from 'wagmi';\nimport { CHAIN_ID, L1_CHAIN_ID } from '@/lib/contracts';\n\nexport function useWallet() {\n  const { address, isConnected, isConnecting } = useAccount();\n  const chainId = useChainId();\n  const { switchChain } = useSwitchChain();\n\n  return {\n    address,\n    isConnected,\n    isConnecting,\n    isCorrectChain: chainId === CHAIN_ID || chainId === L1_CHAIN_ID,\n    isL1: chainId === L1_CHAIN_ID,\n    isL2: chainId === CHAIN_ID,\n    chainId,\n    expectedChainId: CHAIN_ID,\n    l1ChainId: L1_CHAIN_ID,\n    switchToL1: () => switchChain({ chainId: L1_CHAIN_ID }),\n    switchToL2: () => switchChain({ chainId: CHAIN_ID }),\n  };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"usage-in-components",children:"Usage in Components"}),"\n",(0,r.jsx)(n.p,{children:"Pages that require a specific network display warnings and provide switch buttons:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'const { isConnected, isL1, switchToL1 } = useWallet();\n\n// Staking page requires L1\n{isConnected && !isL1 && (\n  <div className="warning-banner">\n    <p>Staking operates on L1 Sepolia. Please switch networks.</p>\n    <button onClick={switchToL1}>Switch to L1 Sepolia</button>\n  </div>\n)}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"wallet-connection-flow",children:"Wallet Connection Flow"}),"\n",(0,r.jsx)(n.mermaid,{value:'sequenceDiagram\n    participant U as User\n    participant RK as RainbowKit Modal\n    participant W as Wallet (MetaMask, etc.)\n    participant App as TAL Frontend\n\n    U->>RK: Click "Connect Wallet"\n    RK->>W: Request connection\n    W->>U: Approve connection prompt\n    U->>W: Approve\n    W->>RK: Return address + chainId\n    RK->>App: useAccount() updates\n    App->>App: Check chainId via useWallet()\n    alt Wrong network\n        App->>U: Show network switch warning\n        U->>App: Click "Switch Network"\n        App->>W: switchChain()\n    end\n    App->>App: Enable contract interactions'}),"\n",(0,r.jsx)(n.h2,{id:"react-query-configuration",children:"React Query Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"QueryClient"})," is configured with:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Value"}),(0,r.jsx)(n.th,{children:"Rationale"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"staleTime"})}),(0,r.jsx)(n.td,{children:"60 seconds"}),(0,r.jsx)(n.td,{children:"Prevents redundant RPC calls for contract reads within a 1-minute window"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"refetchOnWindowFocus"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"Avoids unnecessary refetches when switching browser tabs"})]})]})]}),"\n",(0,r.jsx)(n.admonition,{title:"Testnet Configuration",type:"warning",children:(0,r.jsx)(n.p,{children:"Both chains are configured for testnet use only. The Thanos Sepolia custom chain definition and all L1 contract addresses point to Sepolia. Switching to mainnet requires updating chain definitions, RPC URLs, contract addresses, and block explorer URLs."})}),"\n",(0,r.jsx)(n.admonition,{title:"SSR Compatibility",type:"tip",children:(0,r.jsxs)(n.p,{children:["The wagmi config sets ",(0,r.jsx)(n.code,{children:"ssr: true"})," in ",(0,r.jsx)(n.code,{children:"getDefaultConfig()"}),". This ensures server-side rendering works correctly with Next.js 14 by deferring hydration of wallet state."]})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>a,x:()=>o});var t=i(6540);const r={},s=t.createContext(r);function a(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);