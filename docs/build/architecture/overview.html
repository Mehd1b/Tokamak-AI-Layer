<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-architecture/overview" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Architecture Overview | Tokamak AI Layer</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://tokamak-ai-layer.vercel.app/architecture/overview"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Architecture Overview | Tokamak AI Layer"><meta data-rh="true" name="description" content="Tokamak AI Layer (TAL) is an ERC-8004 compliant infrastructure layer that provides trustless AI agent discovery, reputation management, and execution verification. The system is deployed across two layers: Ethereum L1 for economic security via TON Staking, and Tokamak L2 (Optimism-based) for low-cost registry operations and validation logic. This split allows TAL to inherit Ethereum&#x27;s security guarantees for staking and slashing while keeping high-frequency operations like feedback submission and validation affordable on L2."><meta data-rh="true" property="og:description" content="Tokamak AI Layer (TAL) is an ERC-8004 compliant infrastructure layer that provides trustless AI agent discovery, reputation management, and execution verification. The system is deployed across two layers: Ethereum L1 for economic security via TON Staking, and Tokamak L2 (Optimism-based) for low-cost registry operations and validation logic. This split allows TAL to inherit Ethereum&#x27;s security guarantees for staking and slashing while keeping high-frequency operations like feedback submission and validation affordable on L2."><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://tokamak-ai-layer.vercel.app/architecture/overview"><link data-rh="true" rel="alternate" href="https://tokamak-ai-layer.vercel.app/architecture/overview" hreflang="en"><link data-rh="true" rel="alternate" href="https://tokamak-ai-layer.vercel.app/architecture/overview" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Architecture Overview","item":"https://tokamak-ai-layer.vercel.app/architecture/overview"}]}</script><link rel="stylesheet" href="/assets/css/styles.3ab75531.css">
<script src="/assets/js/runtime~main.8a8adb85.js" defer="defer"></script>
<script src="/assets/js/main.4d7b13e1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TAL Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="TAL Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Tokamak AI Layer</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/tokamak-network/Tokamak-AI-Layer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/architecture/overview"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/architecture/overview"><span title="Architecture Overview" class="linkLabel_WmDU">Architecture Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/architecture/trust-model"><span title="Trust Model" class="linkLabel_WmDU">Trust Model</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/architecture/cross-layer-bridge"><span title="Cross-Layer Bridge" class="linkLabel_WmDU">Cross-Layer Bridge</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/contracts/identity-registry"><span title="Smart Contracts" class="categoryLinkLabel_W154">Smart Contracts</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/identity-registry"><span title="Identity Registry" class="linkLabel_WmDU">Identity Registry</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/reputation-registry"><span title="Reputation Registry" class="linkLabel_WmDU">Reputation Registry</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/validation-registry"><span title="Validation Registry" class="linkLabel_WmDU">Validation Registry</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/wston-vault"><span title="WSTON Vault" class="linkLabel_WmDU">WSTON Vault</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/task-fee-escrow"><span title="Task Fee Escrow" class="linkLabel_WmDU">Task Fee Escrow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/deployment-and-security"><span title="Deployment &amp; Security" class="linkLabel_WmDU">Deployment &amp; Security</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sdk/overview"><span title="SDK" class="categoryLinkLabel_W154">SDK</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/app/setup"><span title="Frontend App" class="categoryLinkLabel_W154">Frontend App</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/integration/staking-bridge"><span title="Integration Guides" class="categoryLinkLabel_W154">Integration Guides</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/reference/glossary"><span title="Reference" class="categoryLinkLabel_W154">Reference</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Architecture</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Architecture Overview</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Architecture Overview</h1></header>
<p>Tokamak AI Layer (TAL) is an ERC-8004 compliant infrastructure layer that provides trustless AI agent discovery, reputation management, and execution verification. The system is deployed across two layers: Ethereum L1 for economic security via TON Staking, and Tokamak L2 (Optimism-based) for low-cost registry operations and validation logic. This split allows TAL to inherit Ethereum&#x27;s security guarantees for staking and slashing while keeping high-frequency operations like feedback submission and validation affordable on L2.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="l1l2-architecture-split">L1/L2 Architecture Split<a href="#l1l2-architecture-split" class="hash-link" aria-label="Direct link to L1/L2 Architecture Split" title="Direct link to L1/L2 Architecture Split" translate="no">​</a></h2>
<p>TAL separates concerns between Ethereum L1 and Tokamak L2 to optimize for both security and cost:</p>
<p><strong>Ethereum L1</strong> handles economic security. Operators stake TON via Staking V3 (SeigManager + DepositManager), and slashing is executed against L1 stake. The 7-day Optimism finalization period acts as a natural appeal window before any slash is finalized.</p>
<p><strong>Tokamak L2</strong> handles all registry and validation logic. Agent identity NFTs, reputation aggregation, validation requests, TEE attestation, and bounty distribution all execute on L2 where gas costs are orders of magnitude lower. The L2 contracts maintain a cached view of L1 stake data relayed through the CrossDomainMessenger.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="contract-dependency-graph">Contract Dependency Graph<a href="#contract-dependency-graph" class="hash-link" aria-label="Direct link to Contract Dependency Graph" title="Direct link to Contract Dependency Graph" translate="no">​</a></h2>
<!-- -->
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Where in the code?</div><div class="admonitionContent_BuS1"><ul>
<li class=""><code>TALValidationRegistry</code>: <a class="" href="/contracts/validation-registry"><code>contracts/src/core/TALValidationRegistry.sol</code></a> (1,112 lines)</li>
<li class=""><code>TALIdentityRegistry</code>: <a class="" href="/contracts/identity-registry"><code>contracts/src/core/TALIdentityRegistry.sol</code></a> (905 lines)</li>
<li class=""><code>TALReputationRegistry</code>: <a class="" href="/contracts/reputation-registry"><code>contracts/src/core/TALReputationRegistry.sol</code></a> (717 lines)</li>
<li class=""><code>WSTONVault</code>: <a class="" href="/contracts/wston-vault"><code>contracts/src/core/WSTONVault.sol</code></a> (280 lines)</li>
<li class=""><code>DRBIntegrationModule</code>: <a class="" href="/integration/drb-integration"><code>contracts/src/modules/DRBIntegrationModule.sol</code></a></li>
<li class=""><code>StakingIntegrationModule</code>: <a class="" href="/integration/staking-bridge"><code>contracts/src/modules/StakingIntegrationModule.sol</code></a></li>
<li class="">Bridge contracts: <a class="" href="/architecture/cross-layer-bridge"><code>contracts/src/bridge/</code></a></li>
</ul></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="trust-tiers">Trust Tiers<a href="#trust-tiers" class="hash-link" aria-label="Direct link to Trust Tiers" title="Direct link to Trust Tiers" translate="no">​</a></h2>
<p>TAL implements four trust tiers, each providing escalating security guarantees for AI agent validation:</p>
<table><thead><tr><th>Tier</th><th>Enum Value</th><th>Description</th><th>Security Guarantee</th></tr></thead><tbody><tr><td><del><strong>ReputationOnly</strong></del></td><td><code>0</code></td><td><strong>REJECTED</strong> in V3. The contract reverts with <code>ReputationOnlyNoValidationNeeded()</code> if this model is requested.</td><td>Previously used for lightweight feedback scoring. Removed to enforce economic security on all validations.</td></tr><tr><td><strong>StakeSecured</strong></td><td><code>1</code></td><td>DRB-selected validator re-executes agent output. Validator must hold &gt;= 1,000 TON on L1. Minimum bounty: 10 TON.</td><td>Economic security through slashable stake. Fraudulent validators lose up to 100% of staked collateral.</td></tr><tr><td><strong>TEEAttested</strong></td><td><code>2</code></td><td>Execution verified inside a hardware enclave (SGX, Nitro, TrustZone). TEE provider must be whitelisted. Minimum bounty: 1 TON.</td><td>Hardware-backed integrity guarantee. Failed attestation triggers 50% stake slash.</td></tr><tr><td><strong>Hybrid</strong></td><td><code>3</code></td><td>Combines StakeSecured and TEEAttested. Both validator selection via DRB and TEE attestation verification are required.</td><td>Maximum security: economic + hardware guarantees. Dual verification path.</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Trust tiers are set per-validation-request, not per-agent. The same agent can be validated at different tiers depending on the requester&#x27;s security needs and willingness to pay the bounty.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="data-flows">Data Flows<a href="#data-flows" class="hash-link" aria-label="Direct link to Data Flows" title="Direct link to Data Flows" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="registration-flow">Registration Flow<a href="#registration-flow" class="hash-link" aria-label="Direct link to Registration Flow" title="Direct link to Registration Flow" translate="no">​</a></h3>
<p>An agent owner builds a registration file using the SDK&#x27;s <code>RegistrationBuilder</code>, uploads metadata to IPFS, and calls <code>TALIdentityRegistry.register(ipfsURI)</code>. The contract mints an ERC-721 identity NFT to the owner. Optionally, a ZK identity commitment (Poseidon hash) can be registered for privacy-preserving capability verification.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="reputation-flow">Reputation Flow<a href="#reputation-flow" class="hash-link" aria-label="Direct link to Reputation Flow" title="Direct link to Reputation Flow" translate="no">​</a></h3>
<p>Clients submit feedback via <code>TALReputationRegistry.submitFeedback()</code>, providing a value in the range <code>[-100, 100]</code>, tags, and an optional payment proof. Feedback is stored on-chain and aggregated using <code>ReputationMath.calculateWeightedAverage()</code>, where each reviewer&#x27;s weight is <code>sqrt(stake)</code>. A Merkle root can be updated off-chain for efficient cross-chain verification.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="validation-flow">Validation Flow<a href="#validation-flow" class="hash-link" aria-label="Direct link to Validation Flow" title="Direct link to Validation Flow" translate="no">​</a></h3>
<p>A requester calls <code>TALValidationRegistry.requestValidation()</code> with a bounty, specifying the trust tier (ReputationOnly is rejected in V3). For StakeSecured and Hybrid models, the agent owner must have &gt;= 1,000 TON locked in WSTONVault (dual-staking). A validator is selected via the DRBIntegrationModule (Commit-Reveal2). The selected validator re-executes the task, submits a score and proof, and the bounty is distributed: 10% to the protocol treasury, 9% to the agent owner, and 81% to the validator. If the score is below 50, the agent owner is automatically slashed 50% via WSTONVault.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cross-layer-staking-flow">Cross-Layer Staking Flow<a href="#cross-layer-staking-flow" class="hash-link" aria-label="Direct link to Cross-Layer Staking Flow" title="Direct link to Cross-Layer Staking Flow" translate="no">​</a></h3>
<p><code>TALStakingBridgeL1</code> queries <code>SeigManager.stakeOf()</code> on Ethereum L1 and relays the operator&#x27;s stake amount to <code>TALStakingBridgeL2</code> via the Optimism <code>CrossDomainMessenger</code>. The L2 bridge caches the snapshot and assigns an operator tier (Unverified, Verified, or Premium). See <a class="" href="/architecture/cross-layer-bridge">Cross-Layer Bridge</a> for details.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="design-patterns">Design Patterns<a href="#design-patterns" class="hash-link" aria-label="Direct link to Design Patterns" title="Direct link to Design Patterns" translate="no">​</a></h2>
<p>All TAL contracts follow consistent design patterns inherited from OpenZeppelin&#x27;s battle-tested upgradeable library:</p>
<table><thead><tr><th>Pattern</th><th>Implementation</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>UUPS Proxy</strong></td><td><code>UUPSUpgradeable</code></td><td>All core contracts are upgradeable via the Universal Upgradeable Proxy Standard. Upgrade authority is gated by <code>UPGRADER_ROLE</code>.</td></tr><tr><td><strong>Role-Based Access Control</strong></td><td><code>AccessControlUpgradeable</code></td><td>Granular permissions via named roles: <code>UPGRADER_ROLE</code>, <code>PAUSER_ROLE</code>, <code>TEE_MANAGER_ROLE</code>, <code>DRB_ROLE</code>, <code>DISPUTE_RESOLVER_ROLE</code>, <code>KEEPER_ROLE</code>, <code>SLASHER_ROLE</code>.</td></tr><tr><td><strong>Storage Gaps</strong></td><td><code>uint256[40] private __gap</code></td><td>All upgradeable contracts reserve 28-40 storage slots for future state variables without breaking storage layout.</td></tr><tr><td><strong>Reentrancy Guard</strong></td><td><code>ReentrancyGuard</code></td><td>Applied to all state-changing external functions that transfer value (feedback submission, bounty distribution, slashing).</td></tr><tr><td><strong>Pausable</strong></td><td><code>PausableUpgradeable</code></td><td>Emergency circuit breaker. <code>PAUSER_ROLE</code> holders can halt all state-changing operations instantly.</td></tr><tr><td><strong>EIP-712 Signatures</strong></td><td><code>WALLET_VERIFICATION_TYPEHASH</code></td><td>Used in <code>TALIdentityRegistry</code> for replay-protected wallet verification with domain separation.</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The <code>UPGRADER_ROLE</code> has significant power. In production, this role should be held by a multisig or timelock contract, not an EOA.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="deployed-addresses-thanos-sepolia">Deployed Addresses (Thanos Sepolia)<a href="#deployed-addresses-thanos-sepolia" class="hash-link" aria-label="Direct link to Deployed Addresses (Thanos Sepolia)" title="Direct link to Deployed Addresses (Thanos Sepolia)" translate="no">​</a></h2>
<table><thead><tr><th>Contract</th><th>Address</th></tr></thead><tbody><tr><td>TALIdentityRegistry</td><td><code>0x3f89CD27fD877827E7665A9883b3c0180E22A525</code></td></tr><tr><td>TALReputationRegistry</td><td><code>0x0052258E517835081c94c0B685409f2EfC4D502b</code></td></tr><tr><td>TALValidationRegistry</td><td><code>0x09447147C6E75a60A449f38532F06E19F5F632F3</code></td></tr><tr><td>StakingIntegrationModule</td><td><code>0xDc9d9A78676C600E7Ca55a8D0c63da9462Acfe30</code></td></tr><tr><td>WSTONVault</td><td><code>0x6aa6a7B9e51B636417025403053855B788107C27</code></td></tr><tr><td>TaskFeeEscrow</td><td><code>0x6D68Cd8fD89BF1746A1948783C92A00E591d1227</code></td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps" translate="no">​</a></h2>
<ul>
<li class=""><a class="" href="/architecture/trust-model">Trust Model</a> -- deep dive into stake weighting, slashing, and dispute resolution</li>
<li class=""><a class="" href="/architecture/cross-layer-bridge">Cross-Layer Bridge</a> -- L1/L2 communication, stake relay, and slashing propagation</li>
<li class=""><a class="" href="/contracts/identity-registry">Identity Registry</a> -- ERC-721 agent identities and ZK commitments</li>
<li class=""><a class="" href="/contracts/validation-registry">Validation Registry</a> -- validation request lifecycle and bounty mechanics</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/tokamak-network/Tokamak-AI-Layer/tree/master/docs/docs/architecture/overview.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/architecture/trust-model"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Trust Model</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#l1l2-architecture-split" class="table-of-contents__link toc-highlight">L1/L2 Architecture Split</a></li><li><a href="#contract-dependency-graph" class="table-of-contents__link toc-highlight">Contract Dependency Graph</a></li><li><a href="#trust-tiers" class="table-of-contents__link toc-highlight">Trust Tiers</a></li><li><a href="#data-flows" class="table-of-contents__link toc-highlight">Data Flows</a><ul><li><a href="#registration-flow" class="table-of-contents__link toc-highlight">Registration Flow</a></li><li><a href="#reputation-flow" class="table-of-contents__link toc-highlight">Reputation Flow</a></li><li><a href="#validation-flow" class="table-of-contents__link toc-highlight">Validation Flow</a></li><li><a href="#cross-layer-staking-flow" class="table-of-contents__link toc-highlight">Cross-Layer Staking Flow</a></li></ul></li><li><a href="#design-patterns" class="table-of-contents__link toc-highlight">Design Patterns</a></li><li><a href="#deployed-addresses-thanos-sepolia" class="table-of-contents__link toc-highlight">Deployed Addresses (Thanos Sepolia)</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/architecture/overview">Architecture</a></li><li class="footer__item"><a class="footer__link-item" href="/contracts/identity-registry">Smart Contracts</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Developer Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sdk/overview">SDK Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/app/setup">Frontend App</a></li><li class="footer__item"><a class="footer__link-item" href="/integration/staking-bridge">Integration Guides</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/tokamak-network/Tokamak-AI-Layer" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Tokamak Network.</div></div></div></footer></div>
</body>
</html>